<?php

class Sms_history_M extends MY_Model
{

///////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////// INHERITED PROPERTIES //////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
    protected $_model_name='Sms_history_M.php';
	protected $_table_name = 'sms_history';
    
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////// PUBLIC PROPERTIES /////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
    public $DB_COL_ARRAY=array();
    public $STATUS_ACTIVE='ACTIVE';                 //if ACTIVE
    public $STATUS_UNACTIVE='UNACTIVE';             //if UNACTIVE




//////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////// PUBLIC FUNCTIONS /////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
	

	function __construct (){
		parent::__construct();
	}
///////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////// SETTER FUNCTIONS //////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////
//Initialize some Componenets on new row addition (optional)
public function init_tasks($data){ 
//init other models
return true;   
  
}
//ADD NEW TABLE ROW IN DATABASE 
public function add_row($vals){
    //GET ALL THE FIELDS IN ARRAY 
    $db_row=  $this->grab_row($vals);        
    //PERFROM DIFFERENCT CHECKS BEFORE DATA INSERTION (OPTIONAL)
    ////////////////////////////////////////////////////////////////////////
    $db_row['day']=$this->day;
    $db_row['month']=$this->month;
    $db_row['year']=$this->year;
    $db_row['date']=  $this->date.' '.$this->time.' '.date('A');
    $db_row['jd']=  $this->todayjd;
    if(empty($db_row['priority'])){$db_row['priority']=1;}
    
    //SAVE DATA INTO DATABASE
    return $this->save_db_row($db_row);
}    
	
//VALIDATE DATA BEFORE SAVING NEW RECORD
public function is_valid_data($data){
    if(empty($data['campus_id'])){
        return false;}
    
    ///////////// data is valid to insert or update
    return true;
    
}	   

/////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////// GETTER FUNCTIONS ////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////


public function send_sms($campus_id,$to='',$message='',$priority=4,$force=false){
    $sms=htmlspecialchars_decode($message);
    $data=array('mobile'=>$to,'message'=>$sms,'priority'=>$priority,'campus_id'=>$campus_id);
    if (!empty($sms) && !empty($to) ) {
        $this->add_row($data);
    }
        
}


//////////////////////////////////////////////// END OF CLASS /////////////////////
}